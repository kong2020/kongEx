<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>스프링부트 +Jpa+Thymeleaf예제</title>
</head>

<body>
	<form>
        <div>
            <label>TODO 내용 </label>
            <textarea id="contents" placeholder="내용을 입력하세요"></textarea>
        </div>
    </form>
    <div>
		<button type="button">취소</button>
        <button type="button" id="btn-save">등록</button>
    </div>
    &nbsp;
	<table id="table" cellspacing="0" cellpadding="10" border="1">
		<thead>
			<tr>
				<th>&nbsp;</th>
				<th>등록번호</th>
				<th>할일</th>
				<th>완료여부</th>
				<th>수정일시</th>
				<th>&nbsp;</th>
			</tr>
		</thead>
		<tbody id="tbody">
			<tr th:each="todo : ${todoList}">
				<td><input type="checkbox" id="checkbox"></td>
				<td th:text="${todo.id}">등록번호</td>
				<td th:text="${todo.contents}">할일</td>
				<td th:text="${todo.done ? '완료' : '미완료'}">완료여부</td>
				<td th:text="${todo.modifiedDate}">수정일시</td>
				<td class="del"><a href="#">삭제</a></td>
			</tr>
		</tbody>
	</table>
</body>

<script	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/app/main.js"></script>

<script type="text/javascript">

	$(document).on("click", ".del", (function() {
		var $this = $(this);
		var xxx = $(this).siblings().eq(1).text();
		console.log("xxx=", xxx);

		var data = {
	        id : xxx
	    };
		
		$.ajax({
			type : 'DELETE',
			url : '/todoDelete',
			dataType : 'json',
			contentType : 'application/json; charset=utf-8',
			data: JSON.stringify(data)
		}).done(function(result) {
			console.log("result=", result);
			$this.closest("tr").remove();
			
		}).fail(function(error) {
			alert('글 삭제 시 오류가 발생했습니다.' + error);
		});
	}));
	
	/* 
	//테이블의 Row 클릭시 값 가져오기
	$("#table tr").click(function() {
		// 현재 클릭된 Row
		var tr = $(this);
		var td = tr.children();

		// tr.text()는 클릭된 Row 즉 tr에 있는 모든 값을 가져온다.
		//console.log("클릭한 Row의 모든 데이터 : ", tr.text());

		// td.eq(index)를 통해 값을 가져올 수도 있다.
		var seq = td.eq(0).text();
		var contents = td.eq(1).text();
		var done = td.eq(2).text();
		console.log("클릭한 Row의  seq=", seq);
	});	
	*/	
		
</script>

</html>